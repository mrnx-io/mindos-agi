# =============================================================================
# MindOS - Local Development Environment
# =============================================================================

# -----------------------------------------------------------------------------
# Core Settings
# -----------------------------------------------------------------------------
NODE_ENV=development
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# Database (Postgres + pgvector)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/mindos
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=mindos

# -----------------------------------------------------------------------------
# Restate (Local)
# -----------------------------------------------------------------------------
RESTATE_INGRESS_URL=http://restate:8080
RESTATE_ADMIN_URL=http://restate:9070
# Optional for Restate Cloud auth
RESTATE_API_KEY=

# -----------------------------------------------------------------------------
# Model API Keys (Multi-Model Cognition)
# -----------------------------------------------------------------------------
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
GOOGLE_AI_API_KEY=...
XAI_API_KEY=xai-...

# -----------------------------------------------------------------------------
# Model Routing Configuration
# -----------------------------------------------------------------------------
MODEL_PRIMARY=gpt-5.2
MODEL_FALLBACK_1=claude-opus-4-5-20251101
MODEL_FALLBACK_2=gemini-3-pro
MODEL_FAST=gpt-5.2-mini

# Optional role-specific overrides
# MODEL_PLANNER=gpt-5.2
# MODEL_VERIFIER=gpt-5.2
# MODEL_WRITER=claude-opus-4-5-20251101
# MODEL_TOOLCALLER=grok-4-1-fast
# MODEL_METACOGNITION=claude-opus-4-5-20251101
# MODEL_REASONING=grok-4-1-fast-reasoning

# -----------------------------------------------------------------------------
# Embeddings
# -----------------------------------------------------------------------------
EMBEDDING_MODEL=text-embedding-3-large
EMBEDDING_DIMENSIONS=3072

# -----------------------------------------------------------------------------
# Autonomy Thresholds
# -----------------------------------------------------------------------------
RISK_THRESHOLD_AUTO=0.35
RISK_THRESHOLD_APPROVAL=0.60
RISK_THRESHOLD_BLOCK=0.90
MAX_AGENT_ITERS=20
CONFIDENCE_THRESHOLD=0.75

# -----------------------------------------------------------------------------
# Service URLs (Docker Compose)
# -----------------------------------------------------------------------------
TOOLMESH_URL=http://toolmesh:9000
EXECUTOR_URL=http://executor:9100
# For local executor (Option 1), use: EXECUTOR_URL=http://localhost:3002
GROUNDING_SERVICE_URL=http://grounding-service:9200
SWARM_COORDINATOR_URL=http://swarm-coordinator:9400

# -----------------------------------------------------------------------------
# Service Tokens (Generate secure random strings)
# -----------------------------------------------------------------------------
TOOLMESH_TOKEN=change-me-minimum-32-characters-long
EXECUTOR_TOKEN=change-me-minimum-32-characters-long
GROUNDING_TOKEN=change-me-minimum-32-characters-long

# -----------------------------------------------------------------------------
# ToolMesh
# -----------------------------------------------------------------------------
MCP_SERVERS_PATH=./apps/toolmesh/mcp.servers.json
DEFAULT_RETRY_BUDGET=3
DEFAULT_RETRY_DELAY_MS=1000
MAX_RETRY_DELAY_MS=30000

# -----------------------------------------------------------------------------
# Executor Limits
# -----------------------------------------------------------------------------
EXECUTOR_TIMEOUT_MS=86400000
EXECUTOR_MAX_MEMORY_MB=256
# Allow full local access (use with caution)
EXECUTOR_ALLOW_ALL=true

# -----------------------------------------------------------------------------
# Grounding Service
# -----------------------------------------------------------------------------
WIKIPEDIA_API_URL=https://en.wikipedia.org/api/rest_v1
BRAVE_API_KEY=
GROUNDING_MODEL=gpt-5.2-mini
GROUNDING_CONFIDENCE_THRESHOLD=0.80

# -----------------------------------------------------------------------------
# Drift Monitor
# -----------------------------------------------------------------------------
PROBE_INTERVAL_MINUTES=60
QUALITY_THRESHOLD=0.85
ALERT_WEBHOOK_URL=
DRIFT_MONITORED_MODELS=gpt-5.2,gpt-5.2-mini,claude-opus-4-5-20251101,gemini-3-pro

# -----------------------------------------------------------------------------
# Swarm Coordinator
# -----------------------------------------------------------------------------
CONSENSUS_TIMEOUT_MS=30000
MAX_SWARM_SIZE=10
HEARTBEAT_INTERVAL_MS=5000

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
ENABLE_METACOGNITION=true
ENABLE_WORLD_MODEL=true
ENABLE_SWARM=true
ENABLE_GROUNDING=true

# Metacognition & Self-Improvement
ENABLE_HYPOTHESIS_ACTIONS=true
ENABLE_AUTO_CALIBRATION=true
ENABLE_AUTO_CONFLICT_RESOLUTION=true
ENABLE_SKILL_EFFECTIVENESS_TRACKING=true
CALIBRATION_MAX_SINGLE_ADJUSTMENT=0.05
CALIBRATION_MAX_CUMULATIVE_DRIFT=0.2
CALIBRATION_COOLDOWN_MS=86400000
CONFLICT_AUTO_RESOLVE_THRESHOLD=0.5

# World Model Integration
ENABLE_WORLD_MODEL_SIMULATION=true
WORLD_MODEL_LOOKAHEAD_STEPS=3
WORLD_MODEL_LOOKAHEAD_INTERVAL=2
WORLD_MODEL_CHECKPOINT_THRESHOLD=0.6
WORLD_MODEL_CHECKPOINT_TTL_MS=3600000
WORLD_MODEL_HISTORY_LOOKBACK_DAYS=30
ENABLE_COUNTERFACTUAL_ANALYSIS=true

# Swarm Collaboration
SWARM_DELEGATION_MIN_STEPS=5
SWARM_DELEGATION_MIN_DURATION_MS=120000
SWARM_DELEGATION_RISK_THRESHOLD=0.6
SWARM_COLLABORATION_ANALYSIS_ENABLED=true
SWARM_SPECIALIZATION_THRESHOLD=0.7

# Cross-Verification
CROSS_VERIFY_ALL_WEB_SEARCH=true
CROSS_VERIFY_MIN_CONFIDENCE=0.6
CROSS_VERIFY_REQUIRE_CORROBORATION=false

# Notifications
NOTIFICATION_WEBHOOK_URL=
NOTIFICATION_SLACK_WEBHOOK_URL=
NOTIFY_ON_SIGNIFICANT_CALIBRATION=true
NOTIFY_ON_SKILL_CREATION=true
NOTIFY_ON_CONFLICT_ESCALATION=true
SIGNIFICANT_CALIBRATION_THRESHOLD=0.1

# -----------------------------------------------------------------------------
# xAI Agent Tools Configuration
# -----------------------------------------------------------------------------
XAI_ENABLE_AGENT_TOOLS=true
XAI_AGENT_TOOLS_ENABLED=web_search,x_search,code_execution,mcp
XAI_PREFER_AGENT_TOOLS=false
XAI_CODE_EXECUTION_TIMEOUT_MS=300000

# -----------------------------------------------------------------------------
# On-Demand Tool Discovery
# -----------------------------------------------------------------------------
ENABLE_ON_DEMAND_TOOLS=true
ENABLE_PROACTIVE_TOOL_DISCOVERY=true
TOOL_DISCOVERY_INITIAL_K=8
TOOL_DISCOVERY_EXPANSION_K=5
TOOL_DISCOVERY_MIN_SIMILARITY=0.4
TOOL_DISCOVERY_CACHE_TTL_MS=300000

# -----------------------------------------------------------------------------
# MCP Server Credentials (optional)
# -----------------------------------------------------------------------------
GITHUB_TOKEN=
SLACK_BOT_TOKEN=
SLACK_TEAM_ID=
GOOGLE_CREDENTIALS_PATH=

# -----------------------------------------------------------------------------
# Optional: Graphiti (docker profile "with-graphiti")
# -----------------------------------------------------------------------------
NEO4J_PASSWORD=password
