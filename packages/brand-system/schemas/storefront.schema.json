{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "version": "1.1.0",
  "description": "Storefront output schema",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "metadata",
    "storefront"
  ],
  "properties": {
    "storefront": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "artifact_architecture",
        "value_ladder_build",
        "funnel_implementation",
        "dr_rule_compliance",
        "dr_permission_matrix",
        "token_application",
        "voice_application",
        "sugarman_audit",
        "moment_implementation",
        "anti_pattern_compliance",
        "paradox_verification",
        "derivation_log"
      ],
      "properties": {
        "artifact_architecture": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "type_specification",
            "page_section_inventory",
            "component_architecture"
          ],
          "properties": {
            "type_specification": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "artifact_type",
                "technical_stack",
                "technical_stack_id",
                "performance_requirements"
              ],
              "properties": {
                "artifact_type": {
                  "type": "string",
                  "minLength": 1
                },
                "technical_stack": {
                  "type": "string",
                  "minLength": 1
                },
                "performance_requirements": {
                  "type": "string",
                  "minLength": 1
                },
                "technical_stack_id": {
                  "$ref": "./_defs.json#/definitions/stack_id"
                }
              }
            },
            "page_section_inventory": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "name",
                  "funnel_stage",
                  "awareness_level",
                  "voice_mode",
                  "lf8_primary"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 1
                  },
                  "funnel_stage": {
                    "$ref": "./_defs.json#/definitions/funnel_phase_id"
                  },
                  "awareness_level": {
                    "$ref": "./_defs.json#/definitions/awareness_id"
                  },
                  "voice_mode": {
                    "$ref": "./_defs.json#/definitions/voice_mode_id"
                  },
                  "lf8_primary": {
                    "$ref": "./_defs.json#/definitions/lf8_id"
                  }
                }
              }
            },
            "component_architecture": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "component_id",
                  "source_room",
                  "token_references",
                  "usage_contexts"
                ],
                "properties": {
                  "source_room": {
                    "$ref": "./_defs.json#/definitions/room_id"
                  },
                  "token_references": {
                    "$ref": "./_defs.json#/definitions/string_list",
                    "minItems": 1
                  },
                  "usage_contexts": {
                    "$ref": "./_defs.json#/definitions/string_list",
                    "minItems": 1
                  },
                  "component_id": {
                    "$ref": "./_defs.json#/definitions/artifact_component_id"
                  }
                }
              }
            }
          }
        },
        "value_ladder_build": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "bait",
            "frontend",
            "middle",
            "backend",
            "continuity"
          ],
          "properties": {
            "bait": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "offer",
                "location",
                "mechanism",
                "next_step",
                "lf8_served"
              ],
              "properties": {
                "offer": {
                  "type": "string",
                  "minLength": 1
                },
                "location": {
                  "type": "string",
                  "minLength": 1
                },
                "mechanism": {
                  "type": "string",
                  "minLength": 1
                },
                "next_step": {
                  "type": "string",
                  "minLength": 1
                },
                "lf8_served": {
                  "$ref": "./_defs.json#/definitions/lf8_id"
                }
              }
            },
            "frontend": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "offer",
                "location",
                "price_point",
                "value_equation",
                "next_step",
                "lf8_served"
              ],
              "properties": {
                "offer": {
                  "type": "string",
                  "minLength": 1
                },
                "location": {
                  "type": "string",
                  "minLength": 1
                },
                "price_point": {
                  "type": "string",
                  "minLength": 1
                },
                "value_equation": {
                  "type": "string",
                  "minLength": 1
                },
                "next_step": {
                  "type": "string",
                  "minLength": 1
                },
                "lf8_served": {
                  "$ref": "./_defs.json#/definitions/lf8_id"
                }
              }
            },
            "middle": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "offer",
                "location",
                "price_point",
                "lf8_served"
              ],
              "properties": {
                "offer": {
                  "type": "string",
                  "minLength": 1
                },
                "location": {
                  "type": "string",
                  "minLength": 1
                },
                "price_point": {
                  "type": "string",
                  "minLength": 1
                },
                "lf8_served": {
                  "$ref": "./_defs.json#/definitions/lf8_id"
                }
              }
            },
            "backend": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "offer",
                "location",
                "price_point",
                "qualification",
                "lf8_served"
              ],
              "properties": {
                "offer": {
                  "type": "string",
                  "minLength": 1
                },
                "location": {
                  "type": "string",
                  "minLength": 1
                },
                "price_point": {
                  "type": "string",
                  "minLength": 1
                },
                "qualification": {
                  "type": "string",
                  "minLength": 1
                },
                "lf8_served": {
                  "$ref": "./_defs.json#/definitions/lf8_id"
                }
              }
            },
            "continuity": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "offer",
                "location",
                "price_point",
                "lf8_served"
              ],
              "properties": {
                "offer": {
                  "type": "string",
                  "minLength": 1
                },
                "location": {
                  "type": "string",
                  "minLength": 1
                },
                "price_point": {
                  "type": "string",
                  "minLength": 1
                },
                "lf8_served": {
                  "$ref": "./_defs.json#/definitions/lf8_id"
                }
              }
            }
          }
        },
        "funnel_implementation": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": [
              "stage",
              "traffic_temperature",
              "awareness_entry",
              "awareness_exit",
              "entry_point",
              "content_experience",
              "voice_mode",
              "lf8_primary",
              "conversion_mechanism",
              "enhancers",
              "manana_antidotes",
              "moments_of_truth",
              "metrics",
              "dr_rules_applied"
            ],
            "properties": {
              "stage": {
                "$ref": "./_defs.json#/definitions/funnel_phase_id"
              },
              "traffic_temperature": {
                "type": "string",
                "enum": [
                  "Hot",
                  "Warm",
                  "Cold"
                ]
              },
              "awareness_entry": {
                "$ref": "./_defs.json#/definitions/awareness_id"
              },
              "awareness_exit": {
                "$ref": "./_defs.json#/definitions/awareness_id"
              },
              "entry_point": {
                "type": "string",
                "minLength": 1
              },
              "content_experience": {
                "type": "string",
                "minLength": 1
              },
              "voice_mode": {
                "$ref": "./_defs.json#/definitions/voice_mode_id"
              },
              "lf8_primary": {
                "$ref": "./_defs.json#/definitions/lf8_id"
              },
              "lf8_secondary": {
                "$ref": "./_defs.json#/definitions/lf8_id"
              },
              "conversion_mechanism": {
                "type": "string",
                "minLength": 1
              },
              "enhancers": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "id",
                    "application"
                  ],
                  "properties": {
                    "id": {
                      "$ref": "./_defs.json#/definitions/enhancer_id"
                    },
                    "application": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              },
              "manana_antidotes": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "id",
                    "application"
                  ],
                  "properties": {
                    "id": {
                      "$ref": "./_defs.json#/definitions/manana_antidote_id"
                    },
                    "application": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              },
              "moments_of_truth": {
                "$ref": "./_defs.json#/definitions/string_list",
                "minItems": 1
              },
              "metrics": {
                "type": "string",
                "minLength": 1
              },
              "dr_rules_applied": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "./_defs.json#/definitions/dr_rule_id"
                }
              }
            }
          }
        },
        "dr_rule_compliance": {
          "type": "array",
          "minItems": 10,
          "maxItems": 10,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": [
              "rule_id",
              "requirement",
              "implementation",
              "verification"
            ],
            "properties": {
              "rule_id": {
                "$ref": "./_defs.json#/definitions/dr_rule_id"
              },
              "requirement": {
                "type": "string",
                "minLength": 1
              },
              "implementation": {
                "type": "string",
                "minLength": 1
              },
              "verification": {
                "type": "string",
                "minLength": 1
              }
            }
          }
        },
        "dr_permission_matrix": {
          "type": "array",
          "minItems": 5,
          "maxItems": 5,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": [
              "enhancer_id",
              "law_permission",
              "non_negotiables",
              "evidence_required",
              "failure_signature",
              "recovery_ritual_reference"
            ],
            "properties": {
              "enhancer_id": {
                "$ref": "./_defs.json#/definitions/enhancer_id"
              },
              "law_permission": {
                "$ref": "./_defs.json#/definitions/string_list",
                "minItems": 1
              },
              "non_negotiables": {
                "$ref": "./_defs.json#/definitions/string_list",
                "minItems": 1
              },
              "evidence_required": {
                "type": "string",
                "minLength": 1
              },
              "failure_signature": {
                "type": "string",
                "minLength": 1
              },
              "recovery_ritual_reference": {
                "type": "string",
                "minLength": 1
              }
            }
          }
        },
        "token_application": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "spacing",
            "color",
            "typography",
            "motion",
            "copy_rhythm"
          ],
          "properties": {
            "spacing": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "context",
                  "token",
                  "value",
                  "justification"
                ],
                "properties": {
                  "context": {
                    "type": "string",
                    "minLength": 1
                  },
                  "token": {
                    "type": "string",
                    "minLength": 1
                  },
                  "value": {
                    "type": "string",
                    "minLength": 1
                  },
                  "justification": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            },
            "color": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "context",
                  "token",
                  "value",
                  "lf8_response"
                ],
                "properties": {
                  "context": {
                    "type": "string",
                    "minLength": 1
                  },
                  "token": {
                    "type": "string",
                    "minLength": 1
                  },
                  "value": {
                    "type": "string",
                    "minLength": 1
                  },
                  "lf8_response": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            },
            "typography": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "level",
                  "token",
                  "size_weight",
                  "usage"
                ],
                "properties": {
                  "level": {
                    "type": "string",
                    "minLength": 1
                  },
                  "token": {
                    "type": "string",
                    "minLength": 1
                  },
                  "size_weight": {
                    "type": "string",
                    "minLength": 1
                  },
                  "usage": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            },
            "motion": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "transition",
                  "token",
                  "timing",
                  "easing",
                  "psychological_purpose"
                ],
                "properties": {
                  "transition": {
                    "type": "string",
                    "minLength": 1
                  },
                  "token": {
                    "type": "string",
                    "minLength": 1
                  },
                  "timing": {
                    "type": "string",
                    "minLength": 1
                  },
                  "easing": {
                    "type": "string",
                    "minLength": 1
                  },
                  "psychological_purpose": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            },
            "copy_rhythm": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "context",
                  "token",
                  "pattern",
                  "justification"
                ],
                "properties": {
                  "context": {
                    "type": "string",
                    "minLength": 1
                  },
                  "token": {
                    "type": "string",
                    "minLength": 1
                  },
                  "pattern": {
                    "type": "string",
                    "minLength": 1
                  },
                  "justification": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            }
          }
        },
        "voice_application": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "page_copy_audit",
            "microcopy_lexicon_audit",
            "error_states"
          ],
          "properties": {
            "page_copy_audit": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "page",
                  "headline_formula_id",
                  "voice_mode",
                  "lf8",
                  "slippery_slide_check"
                ],
                "properties": {
                  "page": {
                    "type": "string",
                    "minLength": 1
                  },
                  "headline_formula_id": {
                    "$ref": "./_defs.json#/definitions/headline_formula_id"
                  },
                  "voice_mode": {
                    "$ref": "./_defs.json#/definitions/voice_mode_id"
                  },
                  "lf8": {
                    "$ref": "./_defs.json#/definitions/lf8_id"
                  },
                  "slippery_slide_check": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            },
            "microcopy_lexicon_audit": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "element",
                  "copy",
                  "sacred_words",
                  "forbidden_words",
                  "verdict"
                ],
                "properties": {
                  "element": {
                    "type": "string",
                    "minLength": 1
                  },
                  "copy": {
                    "type": "string",
                    "minLength": 1
                  },
                  "sacred_words": {
                    "$ref": "./_defs.json#/definitions/string_list"
                  },
                  "forbidden_words": {
                    "$ref": "./_defs.json#/definitions/string_list"
                  },
                  "verdict": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            },
            "error_states": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "error",
                  "message",
                  "recovery_ritual_reference",
                  "tone"
                ],
                "properties": {
                  "error": {
                    "type": "string",
                    "minLength": 1
                  },
                  "message": {
                    "type": "string",
                    "minLength": 1
                  },
                  "recovery_ritual_reference": {
                    "type": "string",
                    "minLength": 1
                  },
                  "tone": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              }
            }
          }
        },
        "sugarman_audit": {
          "type": "array",
          "minItems": 23,
          "maxItems": 23,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": [
              "element_id",
              "status",
              "location",
              "notes"
            ],
            "properties": {
              "element_id": {
                "$ref": "./_defs.json#/definitions/sugarman_element_id"
              },
              "status": {
                "type": "string",
                "minLength": 1
              },
              "location": {
                "type": "string",
                "minLength": 1
              },
              "notes": {
                "type": "string",
                "minLength": 1
              }
            }
          }
        },
        "moment_implementation": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": [
              "moment",
              "tier",
              "location",
              "awareness_entry",
              "awareness_exit",
              "lf8_primary",
              "behavioral_standard_implementation",
              "tempo",
              "enhancers_applied",
              "threshold_honor",
              "failure_detection",
              "recovery_implementation",
              "verification_method"
            ],
            "properties": {
              "moment": {
                "type": "string",
                "minLength": 1
              },
              "tier": {
                "type": "integer",
                "minimum": 1,
                "maximum": 3
              },
              "location": {
                "type": "string",
                "minLength": 1
              },
              "awareness_entry": {
                "$ref": "./_defs.json#/definitions/awareness_id"
              },
              "awareness_exit": {
                "$ref": "./_defs.json#/definitions/awareness_id"
              },
              "lf8_primary": {
                "$ref": "./_defs.json#/definitions/lf8_id"
              },
              "lf8_secondary": {
                "$ref": "./_defs.json#/definitions/lf8_id"
              },
              "behavioral_standard_implementation": {
                "type": "string",
                "minLength": 1
              },
              "tempo": {
                "type": "object",
                "additionalProperties": false,
                "required": [
                  "timing",
                  "energy",
                  "bow"
                ],
                "properties": {
                  "timing": {
                    "type": "string",
                    "minLength": 1
                  },
                  "energy": {
                    "type": "string",
                    "minLength": 1
                  },
                  "bow": {
                    "type": "string",
                    "minLength": 1
                  }
                }
              },
              "enhancers_applied": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": [
                    "id",
                    "application"
                  ],
                  "properties": {
                    "id": {
                      "$ref": "./_defs.json#/definitions/enhancer_id"
                    },
                    "application": {
                      "type": "string",
                      "minLength": 1
                    }
                  }
                }
              },
              "threshold_honor": {
                "type": "string",
                "minLength": 1
              },
              "failure_detection": {
                "type": "string",
                "minLength": 1
              },
              "recovery_implementation": {
                "type": "string",
                "minLength": 1
              },
              "verification_method": {
                "type": "string",
                "minLength": 1
              }
            }
          }
        },
        "anti_pattern_compliance": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": [
              "anti_pattern",
              "competitor_behavior",
              "our_artifact",
              "compliant"
            ],
            "properties": {
              "anti_pattern": {
                "type": "string",
                "minLength": 1
              },
              "competitor_behavior": {
                "type": "string",
                "minLength": 1
              },
              "our_artifact": {
                "type": "string",
                "minLength": 1
              },
              "compliant": {
                "type": "boolean"
              }
            }
          }
        },
        "paradox_verification": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "logic_test",
            "mystery_test",
            "mystery_proxy_metrics"
          ],
          "properties": {
            "logic_test": {
              "$ref": "./_defs.json#/definitions/string_list",
              "minItems": 1
            },
            "mystery_test": {
              "$ref": "./_defs.json#/definitions/string_list",
              "minItems": 1
            },
            "mystery_proxy_metrics": {
              "type": "object",
              "additionalProperties": false,
              "required": [
                "whitespace_ratio",
                "information_density",
                "open_loop_ratio",
                "explanation_to_implication_ratio",
                "named_reasons_before_consequence"
              ],
              "properties": {
                "whitespace_ratio": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1
                },
                "information_density": {
                  "type": "number",
                  "minimum": 0
                },
                "open_loop_ratio": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1
                },
                "explanation_to_implication_ratio": {
                  "type": "number",
                  "minimum": 0
                },
                "named_reasons_before_consequence": {
                  "type": "number",
                  "minimum": 0
                }
              }
            }
          }
        },
        "derivation_log": {
          "$ref": "./_defs.json#/definitions/derivation_log"
        }
      }
    },
    "metadata": {
      "$ref": "./provenance.schema.json"
    }
  }
}
